<!DOCTYPE HTML>
<html lang="en">
  <head>
  <meta charset="UTF-8">
  <title>Adding Your Own Differ to RSpec - Ryan Bigg</title>
  <link rel="shortcut icon" href="https://ryanbigg.com/favicon.png" type="image/x-icon">
  <link href="http://feeds.feedburner.com/ryanbigg" rel="alternate" title="The Life of a Radar" type="application/atom+xml" />
  <link href="https://fonts.googleapis.com/css?family=Ubuntu+Mono|Oxygen|Encode+Sans+Condensed" rel="stylesheet">
  <link rel='stylesheet' href='https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css'>
  <link rel='stylesheet' href='/css/style.css' media='screen'>
  <script src='/js/prism.js'></script>
  <meta name="viewport" content="width=device-width, initial-scale=1">
</head>


  <body>
    <div class="main">
      <header class="topbar">
        <img src='/images/me.png' />

<h1><a href='/'>Ryan Bigg</a></h1>

<a href="/">Who?</a> &middot; <a href="/books">Books</a> &middot; <a href="/blog">Blog</a><br>

<a href="/history">History</a> &middot; <a href="/now">Now</a><br>

<a href="/contact-me">Contact me</a>

      </header>

      <div class='content'>
        <div class='content-inner'>
          <article>
            <div class='center'>
              <a href="/2009/07/adding-your-own-differ-to-rspec"><h2>Adding Your Own Differ to RSpec</h2></a>
              <small>17 Jul 2009</small>
            </div>
            <p>Recently I <a href='https://rspec.lighthouseapp.com/projects/5645/tickets/848-diff_as_hash'>added diff<em>as</em>hash to rspec</a> and I&#39;d like to show you what I did, so you can add your own differs, and it&#39;s only a couple of lines of code. You can edit your own local gem copy of rspec using the find<em>gem gem&#39;s edit</em>gem command.</p>

<p>Let&#39;s use the example that you want to add a BigDecimal differ.</p>

<h3><em>lib/spec/expectations/fail_with.rb</em></h3>

<p>First of all you&#39;re going to need to add a line to this file, something that looks like the lines here, along with the other <span class='term'>elsif</span>s:</p>

<script src="http://gist.github.com/148909.js"></script>

<h3><em>lib/spec/runner/differs/default.rb</em></h3>

<p>Secondly, in this file inside the <span class='term'>Spec::Expectations::Differs::Default</span> class you&#39;ll have to define your <span class='term'>diff<em>as</em>big_decimal</span> differ:</p>

<script src="http://gist.github.com/148912.js"></script>

<p>Now when you diff BigDecimal numbers in your rspec tests, you&#39;ll see this output, rather than the ugly output.</p>

<p>However, what would be nicer is if you could expand on this diffing syntax in your own project, rather than having to hack rspec and have it wiped next time you upgrade. More on that later though.</p>

          </article>
        </div>
      </div>
    </div>

    <script type="text/javascript">
        var disqus_shortname = 'ryanbigg'; // required: replace example with your forum shortname

        var disqus_identifier = '666 http://ryanbigg.com/?p=666'
        var disqus_url = 'http://ryanbigg.com/2009/07/adding-your-own-differ-to-rspec';
    </script>
    <script src='http://ryanbigg.disqus.com/embed.js'></script>

    <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
    <a href="http://disqus.com" class="dsq-brlink">blog comments powered by <span class="logo-disqus">Disqus</span></a>
    <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

      ga('create', 'UA-60556315-1', 'auto');
      ga('send', 'pageview');

    </script>
  </body>
</html>
