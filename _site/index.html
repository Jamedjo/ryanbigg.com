<!DOCTYPE HTML>
<html>
  <head>
    <title>Home - Blog of Ryan Bigg</title>
    <link href="http://feeds.feedburner.com/ryanbigg" rel="alternate" title="The Life of a Radar" type="application/atom+xml" />
    <link href='http://fonts.googleapis.com/css?family=Buenard' rel='stylesheet' type='text/css'>
    <link rel='stylesheet' href='/css/style.css' media='screen'>
    <link rel='stylesheet' href='/css/mobile.css'>
    <link rel='stylesheet' href='/css/highlight.css'>

  <body>
    <h1 align='center'>The Life of a Radar</h1>
    <div id='page'>
      <div id="header">
        <p>Hi there, my parents and friends call me Ryan Bigg, but you may know me as "Radar". Either is fine.</p>
        <p>I'm a technical writer for Ruby / Rails based in Australia. I have written a Rails book with <a href="http://yehudakatz.com">Yehuda Katz</a> called <a href="http://manning.com/bigg2">Rails 4 in Action</a>, which is available also on <a href='http://www.amazon.com/Rails-3-Action-Ryan-Bigg/dp/1935182277'>Amazon</a>. I wrote <a href='http://leanpub.com/multi-tenancy-rails'>Multitenancy With Rails</a>, and I'm in the process of writing my third book <a href='http://leanpub.com/debuggingruby'>Debugging Ruby</a>.
        </p>

        <div id="more">
          <p>
          I won a <a href='http://rubyheroes.com'>Ruby Hero</a> award in 2011 for my work on documentation for Rails. I keep some guides in my <a href='http://github.com/radar/guides'>guides</a> repository on GitHub. As part of this documentation, I've worked on the <a href='http://guides.rubyonrails.org/asset_pipeline.html'>Asset Pipeline</a>, <a href='http://guides.rubyonrails.org/active_record_querying.html'>Active Record Query Interface</a>, <a href='http://guides.rubyonrails.org/configuring.html'>Configuring Rails Applications</a>, <a href='http://guides.rubyonrails.org/engines.html'>Getting Started with Engines</a> and the <a href='http://guides.rubyonrails.org/initialization.html'>Rails Initialization Internals</a> guides. I've also been known to hang out on <a href='http://stackoverflow.com/users/15245/ryan-bigg'>Stack Overflow</a>.
          </p>
          <p> Occasionally I find some time to write interesting blog posts such as the ones you see below.</p>
          <p>I also have done quite a lot of <a href="http://github.com/radar">open-source work</a> and I <a href="http://twitter.com/ryanbigg">tweet</a>. Find out more <a href="http://ryanbigg.com/about-me">about me</a>.</p> 
          <p>If you like what you see you can <a href='http://feeds.feedburner.com/ryanbigg'>subscribe to this blog</a>.</p>
          <p>You can also <a href='http://airpair.me/ryanbigg'>pair with me</a>.</p>
        </div>
      </div>
      <header></header>
      

<!-- Layout inspired by Nick Quaranto's "Litany Against Fear" blog 
     http://litanyagainstfear.com -->
<article>
  <a href="/2014/09/go-package-management"><header>Go package management</header></a>
  <small>02 Sep 2014</small><br>
  <p>In Ruby-land, we have a wonderful tool called Bundler to manage package dependencies. I can specify dependencies like this:</p>
<div class="highlight"><pre><code class="language-ruby" data-lang="ruby"><span class="n">gem</span> <span class="s1">&#39;rails&#39;</span><span class="p">,</span> <span class="s1">&#39;4.1.5&#39;</span>
</code></pre></div>
<p>When I run <code>bundle install</code>, Bundler will install not only the <code>rails</code> dependency, but all of its dependencies and all of their dependencies and so on. It will then take note of the dependencies which have been resolved and save them to a <code>Gemfile.lock</code>. I can commit this file to Git and push it up to GitHub, then when other people work on my project they can clone it and run <code>bundle install</code> on their machine and work with the exact same dependencies. Another benefit of this is that I can have multiple versions of Rails installed on the machine and when I use Bundler, it will use the correct version of Rails as specified in the Gemfile.</p>

<p>There&#39;s tools out there in Go-land, such as <a href="https://github.com/mattn/gom">gom</a> and <a href="https://github.com/tools/godep">godep</a> which provide similar functionality. I prefer <code>godep</code>, but truth be told I wish that there was a Bundler-for-Go. Godep saves the dependencies in a JSON file:</p>
<div class="highlight"><pre><code class="language-json" data-lang="json"><span class="p">{</span>
  <span class="nt">&quot;ImportPath&quot;</span><span class="p">:</span> <span class="s2">&quot;github.com/radar/my-project&quot;</span><span class="p">,</span>
  <span class="nt">&quot;GoVersion&quot;</span><span class="p">:</span> <span class="s2">&quot;go1.3&quot;</span><span class="p">,</span>
  <span class="nt">&quot;Packages&quot;</span><span class="p">:</span> <span class="p">[</span>
    <span class="s2">&quot;./...&quot;</span>
  <span class="p">],</span>
  <span class="nt">&quot;Deps&quot;</span><span class="p">:</span> <span class="p">[</span>
    <span class="p">{</span>
      <span class="nt">&quot;ImportPath&quot;</span><span class="p">:</span> <span class="s2">&quot;github.com/codegangsta/cli&quot;</span><span class="p">,</span>
      <span class="nt">&quot;Comment&quot;</span><span class="p">:</span> <span class="s2">&quot;1.2.0-22-g687db20&quot;</span><span class="p">,</span>
      <span class="nt">&quot;Rev&quot;</span><span class="p">:</span> <span class="s2">&quot;687db20fc379d1686465a28e9959707cd1acc990&quot;</span>
    <span class="p">},</span>
    <span class="p">{</span>
      <span class="nt">&quot;ImportPath&quot;</span><span class="p">:</span> <span class="s2">&quot;github.com/fatih/color&quot;</span><span class="p">,</span>
      <span class="nt">&quot;Rev&quot;</span><span class="p">:</span> <span class="s2">&quot;3161cccfa22c6243e02aa984cf2886d022024cec&quot;</span>
    <span class="p">},</span>
    <span class="p">{</span>
      <span class="nt">&quot;ImportPath&quot;</span><span class="p">:</span> <span class="s2">&quot;gopkg.in/check.v1&quot;</span><span class="p">,</span>
      <span class="nt">&quot;Rev&quot;</span><span class="p">:</span> <span class="s2">&quot;5b76b26efe7f426789852e983fbde4de62c42282&quot;</span>
    <span class="p">}</span>
  <span class="p">]</span>
<span class="p">}</span>
</code></pre></div>
<p>This is a pretty good solution. <code>godep save</code> will update the dependencies (similar to <code>bundle update</code>), and <code>godep restore</code> will install the dependencies (similar to <code>bundle install</code>) if they aren&#39;t available in <code>GOPATH</code> already.</p>

<hr>

<p>Here&#39;s what I would like though: I want a way that I can specify dependencies for Go projects like I can specify for Ruby projects. Ruby projects have a <code>.gemspec</code> file <a href="http://git.io/teWNMw0">which lists dependencies</a>, and I would like Go projects to do the same thing. For instance, in my project I&#39;d like to specify my dependencies in a very simple JSON syntax (let&#39;s call it <code>deps.json</code>):</p>
<div class="highlight"><pre><code class="language-json" data-lang="json"><span class="p">[</span>
  <span class="p">{</span>
    <span class="err">path:</span> <span class="nt">&quot;github.com/codegangsta/cli&quot;</span><span class="p">,</span>
    <span class="err">rev:</span> <span class="nt">&quot;1.2.0&quot;</span><span class="p">,</span>
  <span class="p">},</span>
  <span class="p">{</span>
    <span class="err">path:</span> <span class="nt">&quot;github.com/fatih/color&quot;</span><span class="p">,</span>
    <span class="err">rev:</span> <span class="nt">&quot;master&quot;</span><span class="p">,</span>
  <span class="p">}</span>
<span class="p">]</span>
</code></pre></div>
<p>Then I would like to run a <code>bundle install</code>-equivalent which creates a <code>deps.json.lock</code>:</p>
<div class="highlight"><pre><code class="language-json" data-lang="json"><span class="p">[</span>
  <span class="p">{</span>
    <span class="err">path:</span> <span class="nt">&quot;github.com/codegangsta/cli&quot;</span><span class="p">,</span>
    <span class="err">rev:</span> <span class="nt">&quot;565493f259bf868adb54d45d5f4c68d405117adf&quot;</span><span class="p">,</span>
  <span class="p">},</span>
  <span class="p">{</span>
    <span class="err">path:</span> <span class="nt">&quot;github.com/fatih/color&quot;</span><span class="p">,</span>
    <span class="err">rev:</span> <span class="nt">&quot;3161cccfa22c6243e02aa984cf2886d022024cec&quot;</span><span class="p">,</span>
  <span class="p">}</span>
<span class="p">]</span>
</code></pre></div>
<p>That&#39;s the first step. The second step is a lot more complex than that, and it involves fetching the dependencies from their sources and setting up a proper <code>GOPATH</code>. See, the issue with the normal <code>GOPATH</code> is that all your dependencies are thrown into the one <code>src</code> directory. This means that if you want to use &quot;Version A&quot; of a project in &quot;Codebase A&quot; and &quot;Version B&quot; of that same project in &quot;Codebase B&quot;, you&#39;re going to have a bad time. This is why I think having a <em>global</em> <code>GOPATH</code> is a terrible idea.</p>

<p>Instead, there should be a project-specific <code>GOPATH</code>. It looks the same as a normal <code>GOPATH</code>, but has the correct dependencies in it. For instance, instead of having a <code>~/Projects/go/src/github.com/radar/my-project</code>, I would have <code>~/Projects/go/my-project</code>, and then underneath that it would have <code>bin</code>, <code>pkg</code> and <code>src</code> directories relevant only to that project. The project&#39;s code itself would exist within <code>Projects/go/my-project/src/github.com/radar/my-project</code>, only because that&#39;s what Go expects.</p>

<p>To setup the project, I would create <code>~/Projects/go/my-project/src/github.com/radar/my-project</code>, and then run that <code>bundle install</code> equivalent. This would clone <code>github.com/codegangsta/cli</code> into <code>~/Projects/go/my-project/src/github.com/codegangsta/cli</code>, and check it out to the ref specified in <code>deps.json.lock</code>. It would then do the same thing with <code>github.com/fatih/color</code>. Now I have the first layer of dependencies that <code>my-project</code> needs.</p>

<p>The third step is where it gets <em>even more difficult</em>. These first layer of dependencies <em>might</em> have dependencies themselves, and so this tool should check for <code>deps.json.lock</code> (or <code>deps.json</code>) within those projects and resolve them as well. This is difficult because you may run into issues like circular dependencies and conflicting version requirements.</p>

<p>I believe if project setup was done this way, multiple Go projects on the same machine can use varying dependencies very easily.</p>

<p>There&#39;s of course caveats: potential disk usage problems, every project needs a <code>deps.json</code>, and the resolution problems. By no means am I suggesting that this is <em>The Way Things Should Be Done</em>. It&#39;s just something that occurred to me tonight that could be a potential beginning towards a solution for the Go package management puzzle.</p>

</article>

<div id='archive'>
  <h2>25 back</h2>
  <ul>
    
      <li><a href="/2014/08/thoughts-on-go">Thoughts on Go</a><abbr>08 Aug 2014</abbr></li>
  
      <li><a href="/2014/08/add-header-to-rack-test-request">Add header to Rack::Test request</a><abbr>06 Aug 2014</abbr></li>
  
      <li><a href="/2014/07/ryan-bigg-is-now-a-git">Ryan Bigg is now a Git...</a><abbr>22 Jul 2014</abbr></li>
  
      <li><a href="/2014/06/initial-thoughts-on-lotus">Initial thoughts on Lotus</a><abbr>19 Jun 2014</abbr></li>
  
      <li><a href="/2014/06/spree-factories-and-callbacks">Spree, Factories and Callbacks</a><abbr>17 Jun 2014</abbr></li>
  
      <li><a href="/2014/04/community-management">Community Management</a><abbr>02 Apr 2014</abbr></li>
  
      <li><a href="/2013/10/violence-in-the-ruby-community">Violence in the Ruby community</a><abbr>14 Oct 2013</abbr></li>
  
      <li><a href="/2013/09/order-adjustments">Order adjustments within Spree</a><abbr>24 Sep 2013</abbr></li>
  
      <li><a href="/2013/09/debugging-rails-controllers">Debugging Rails Controllers</a><abbr>05 Sep 2013</abbr></li>
  
      <li><a href="/2013/08/bundler-local-paths">Bundler local paths</a><abbr>16 Aug 2013</abbr></li>
  
      <li><a href="/2013/07/waiting-for-ajax-in-capybara">Waiting for AJAX in Capybara</a><abbr>09 Jul 2013</abbr></li>
  
      <li><a href="/2013/06/finding-sql-queries-in-rails">Finding SQL queries in Rails</a><abbr>26 Jun 2013</abbr></li>
  
      <li><a href="/2013/02/about-spec-support">About spec/support</a><abbr>02 Feb 2013</abbr></li>
  
      <li><a href="/2013/01/multitenancy-with-rails">Multitenancy with Rails</a><abbr>21 Jan 2013</abbr></li>
  
      <li><a href="/2013/01/a-story-about-scaffolding">A story about scaffolding</a><abbr>07 Jan 2013</abbr></li>
  
      <li><a href="/2012/11/no-more-writing-for-manning">No more writing for Manning</a><abbr>12 Nov 2012</abbr></li>
  
      <li><a href="/2012/11/i-didn-t-submit-a-talk-to-rubyconf-australia">I didn't submit a talk to RubyConf Australia</a><abbr>01 Nov 2012</abbr></li>
  
      <li><a href="/2012/10/javascript-arrays-and-objects">JavaScript Arrays and Objects</a><abbr>03 Oct 2012</abbr></li>
  
      <li><a href="/2012/05/on-hiring">On Hiring</a><abbr>25 May 2012</abbr></li>
  
      <li><a href="/2012/05/how-not-to-hire-me">How not to hire me</a><abbr>25 May 2012</abbr></li>
  
      <li><a href="/2012/05/engines-talk">Engines talk</a><abbr>19 May 2012</abbr></li>
  
      <li><a href="/2012/04/caffeine-and-sleep">Caffeine and Sleep</a><abbr>27 Apr 2012</abbr></li>
  
      <li><a href="/2012/04/integration-testing-engines">Integration testing engines</a><abbr>26 Apr 2012</abbr></li>
  
      <li><a href="/2012/03/polymorphic-routes">Polymorphic Routes</a><abbr>27 Mar 2012</abbr></li>
  
      <li><a href="/2012/03/please-learn-rails">Please learn Rails</a><abbr>17 Mar 2012</abbr></li>
  
  </ul>
  <center><a href='/blogography.html'>The Complete Blogography</a></center>
</div>

    </div>
    <script type="text/javascript">
      var _gauges = _gauges || [];
      (function() {
        var t   = document.createElement('script');
        t.type  = 'text/javascript';
        t.async = true;
        t.id    = 'gauges-tracker';
        t.setAttribute('data-site-id', '4e30f771f5a1f547c8000001');
        t.src = '//secure.gaug.es/track.js';
        var s = document.getElementsByTagName('script')[0];
        s.parentNode.insertBefore(t, s);
      })();
    </script>
  </body>
</html>
